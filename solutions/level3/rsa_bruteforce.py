import random 
import math
prime = []

nums = []

for i in range(0,10000000): # insert estimated range of p and q 
    nums.append(True)
nums[0] = False
nums[1] = False
for x in range(0,len(nums)):
    if nums[x] == True:
        prime.append(x)
        for y in range(x,len(nums),x):
            nums[y] = False

n = 32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522913463688717960921898019494119559150490921095088152386448283120630877367300996091750197750389652106796057638384067568276792218642619756161838094338476170470581645852036305042887575891541065808607552399123930887782275591587889508363629117637447334595233085892667368810756433547177681994737372198488385304437587100550034398482306113972874078051933894630725720130220972266988851711187981434917336536809229169349387700111634347145647804792876954707637674952260583815149011972045262965094901932100011688572970892006758905004251

n_found = False 
#i = 0 
x = 1

for i in range(0,len(prime)):
    if n % prime[i] == 0: 
        p = prime[i]
        q = n // p 
        break
    if prime[i] > math.sqrt(n)+1: 
        print("n could be prime")
        break 
print(p,q)

phi = (p-1) * (q-1)

e = 2
found = False
while found == False:
    if math.gcd(e,phi) == 1:
        found = True
    elif math.gcd(e,phi) != 1:
        e += 1

d = pow(e,-1,phi) # modulares inverses

print(f"d: {d}") 

secret_msg = [1804229351, 19254145824, 10510100501, 8587340257, 21003416576, 33554432, 13382255776, 16850581551, 9039207968, 33554432, 25937424601, 16850581551, 21924480357, 33554432, 11040808032, 16850581551, 21924480357, 16105100000, 10000000000, 33554432, 21003416576, 12166529024, 10510100501, 33554432, 20113571875, 16850581551, 14693280768, 21924480357, 21003416576, 12762815625, 16850581551, 16105100000, 33554432, 6240321451, 10510100501, 16105100000, 9509900499, 19254145824, 25937424601, 17623416832, 21003416576, 282475249, 254803968, 16105100000, 7737809375, 282475249, 20113571875, 7737809375, 14025517307, 345025251, 25937424601, 205962976, 12166529024, 21003416576, 15386239549, 14693280768, 6956883693, 33554432]

clear_message = []
for i in range(0,len(secret_msg)):
    clear_message.append(pow(secret_msg[i],d,n))
    print(chr(clear_message[i]),end="")
